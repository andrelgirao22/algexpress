<!DOCTYPE html>
<html>
<head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
        rel="stylesheet"
        as="style"
        onload="this.rel='stylesheet'"
        href="https://fonts.googleapis.com/css2?display=swap&family=Inter%3Awght%40400%3B500%3B700%3B900&family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />
    <title>Cadastro - AlgExpress</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
</head>
<body>
<div class="relative flex size-full min-h-screen flex-col bg-gradient-to-br from-orange-50 to-red-50 group/design-root overflow-x-hidden" style='font-family: Inter, "Noto Sans", sans-serif;'>
    
    <!-- Header -->
    <header class="flex items-center justify-between whitespace-nowrap bg-white shadow-sm px-10 py-4">
        <div class="flex items-center gap-4 text-[#d2440e]">
            <div class="size-8">
                <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M24 4H42V17.3333V30.6667H24V44H6V30.6667V17.3333H24V4Z" fill="currentColor"></path>
                </svg>
            </div>
            <h1 class="text-[#d2440e] text-2xl font-bold leading-tight tracking-[-0.015em]">AlgExpress</h1>
        </div>
        <div class="flex gap-4">
            <a href="customer_login.html" class="text-[#d2440e] text-sm font-medium hover:text-red-600">Já tenho conta</a>
            <a href="public_menu.html" class="bg-[#d2440e] text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-red-600">Ver Cardápio</a>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex-1 flex items-center justify-center p-8">
        <div class="w-full max-w-md">
            
            <!-- Welcome Card -->
            <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="white" viewBox="0 0 256 256">
                            <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm40-68a12,12,0,0,1-12,12H116v28a12,12,0,0,1-24,0V160H64a12,12,0,0,1,0-24H92V108a12,12,0,0,1,24,0v28h28A12,12,0,0,1,168,148Z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Crie sua conta</h2>
                    <p class="text-gray-600">Cadastre-se e tenha acesso às melhores pizzas da cidade!</p>
                </div>

                <!-- Signup Form -->
                <form id="signupForm" onsubmit="handleSignup(event)">
                    
                    <!-- Nome -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome completo</label>
                        <input
                            type="text"
                            id="name"
                            required
                            placeholder="Digite seu nome completo"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"
                        />
                    </div>

                    <!-- Email -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input
                            type="email"
                            id="email"
                            required
                            placeholder="seu@email.com"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"
                        />
                        <p class="text-xs text-gray-500 mt-1">Usado para confirmação de pedidos</p>
                    </div>

                    <!-- Telefone -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Telefone</label>
                        <input
                            type="tel"
                            id="phone"
                            required
                            placeholder="(11) 99999-9999"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"
                            onkeyup="formatPhone(this)"
                        />
                        <p class="text-xs text-gray-500 mt-1">Para contato sobre entregas</p>
                    </div>

                    <!-- CPF -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">CPF</label>
                        <input
                            type="text"
                            id="cpf"
                            required
                            placeholder="000.000.000-00"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"
                            onkeyup="formatCPF(this)"
                        />
                        <p class="text-xs text-gray-500 mt-1">Para emissão de nota fiscal</p>
                    </div>

                    <!-- Terms -->
                    <div class="mb-6">
                        <label class="flex items-start gap-3">
                            <input type="checkbox" id="terms" required class="mt-1 w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500">
                            <span class="text-sm text-gray-600">
                                Concordo com os 
                                <a href="#" class="text-orange-600 hover:text-orange-700 font-medium">Termos de Uso</a> 
                                e 
                                <a href="#" class="text-orange-600 hover:text-orange-700 font-medium">Política de Privacidade</a>
                            </span>
                        </label>
                    </div>

                    <!-- Marketing -->
                    <div class="mb-6">
                        <label class="flex items-start gap-3">
                            <input type="checkbox" id="marketing" class="mt-1 w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500">
                            <span class="text-sm text-gray-600">
                                Quero receber ofertas especiais e novidades por email
                            </span>
                        </label>
                    </div>

                    <!-- Submit Button -->
                    <button
                        type="submit"
                        class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-3 px-6 rounded-lg font-semibold hover:from-orange-600 hover:to-red-600 transition-all transform hover:scale-105 shadow-lg"
                        id="submitBtn"
                    >
                        Criar minha conta
                    </button>

                </form>

                <!-- Divider -->
                <div class="flex items-center my-6">
                    <div class="flex-1 border-t border-gray-300"></div>
                    <span class="px-4 text-sm text-gray-500">ou</span>
                    <div class="flex-1 border-t border-gray-300"></div>
                </div>

                <!-- Social Login -->
                <div class="space-y-3">
                    <button class="w-full flex items-center justify-center gap-3 bg-white border border-gray-300 py-3 px-6 rounded-lg hover:bg-gray-50 transition-all">
                        <svg width="20" height="20" viewBox="0 0 24 24">
                            <path fill="#4285f4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34a853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#fbbc05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#ea4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        Continuar com Google
                    </button>

                    <button class="w-full flex items-center justify-center gap-3 bg-[#1877f2] text-white py-3 px-6 rounded-lg hover:bg-[#166fe5] transition-all">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                        Continuar com Facebook
                    </button>
                </div>

                <!-- Login Link -->
                <div class="text-center mt-6">
                    <p class="text-sm text-gray-600">
                        Já tem uma conta? 
                        <a href="customer_login.html" class="text-orange-600 hover:text-orange-700 font-medium">Faça login</a>
                    </p>
                </div>
            </div>

            <!-- Benefits -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4 text-center">Vantagens de ter uma conta</h3>
                <div class="space-y-3">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#10b981" viewBox="0 0 256 256">
                                <path d="M176.49,95.51a12,12,0,0,1,0,17l-56,56a12,12,0,0,1-17,0l-24-24a12,12,0,1,1,17-17L112,143l47.51-47.52A12,12,0,0,1,176.49,95.51Z"></path>
                            </svg>
                        </div>
                        <span class="text-sm text-gray-700">Histórico de pedidos sempre disponível</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#f97316" viewBox="0 0 256 256">
                                <path d="M176.49,95.51a12,12,0,0,1,0,17l-56,56a12,12,0,0,1-17,0l-24-24a12,12,0,1,1,17-17L112,143l47.51-47.52A12,12,0,0,1,176.49,95.51Z"></path>
                            </svg>
                        </div>
                        <span class="text-sm text-gray-700">Pontos de fidelidade em cada pedido</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#3b82f6" viewBox="0 0 256 256">
                                <path d="M176.49,95.51a12,12,0,0,1,0,17l-56,56a12,12,0,0,1-17,0l-24-24a12,12,0,1,1,17-17L112,143l47.51-47.52A12,12,0,0,1,176.49,95.51Z"></path>
                            </svg>
                        </div>
                        <span class="text-sm text-gray-700">Endereços salvos para entregas rápidas</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#8b5cf6" viewBox="0 0 256 256">
                                <path d="M176.49,95.51a12,12,0,0,1,0,17l-56,56a12,12,0,0,1-17,0l-24-24a12,12,0,1,1,17-17L112,143l47.51-47.52A12,12,0,0,1,176.49,95.51Z"></path>
                            </svg>
                        </div>
                        <span class="text-sm text-gray-700">Ofertas exclusivas e promoções especiais</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t py-6">
        <div class="max-w-4xl mx-auto px-8 text-center">
            <p class="text-sm text-gray-600">
                © 2024 AlgExpress. Todos os direitos reservados. 
                <span class="mx-2">•</span>
                <a href="#" class="text-orange-600 hover:text-orange-700">Termos</a>
                <span class="mx-2">•</span>
                <a href="#" class="text-orange-600 hover:text-orange-700">Privacidade</a>
                <span class="mx-2">•</span>
                <a href="#" class="text-orange-600 hover:text-orange-700">Contato</a>
            </p>
        </div>
    </footer>

</div>

<script>
const API_BASE = 'http://localhost:8080/api/v1';

// Format phone number
function formatPhone(input) {
    let value = input.value.replace(/\D/g, '');
    value = value.replace(/(\d{2})(\d)/, '($1) $2');
    value = value.replace(/(\d{5})(\d)/, '$1-$2');
    input.value = value;
}

// Format CPF
function formatCPF(input) {
    let value = input.value.replace(/\D/g, '');
    value = value.replace(/(\d{3})(\d)/, '$1.$2');
    value = value.replace(/(\d{3})(\d)/, '$1.$2');
    value = value.replace(/(\d{3})(\d{1,2})/, '$1-$2');
    input.value = value;
}

// Validate CPF
function isValidCPF(cpf) {
    cpf = cpf.replace(/[^\d]+/g, '');
    if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
    
    let sum = 0;
    for (let i = 0; i < 9; i++) {
        sum += parseInt(cpf.charAt(i)) * (10 - i);
    }
    let check1 = (sum * 10) % 11;
    if (check1 === 10) check1 = 0;
    if (check1 !== parseInt(cpf.charAt(9))) return false;
    
    sum = 0;
    for (let i = 0; i < 10; i++) {
        sum += parseInt(cpf.charAt(i)) * (11 - i);
    }
    let check2 = (sum * 10) % 11;
    if (check2 === 10) check2 = 0;
    return check2 === parseInt(cpf.charAt(10));
}

// Handle form submission
async function handleSignup(event) {
    event.preventDefault();
    
    const submitBtn = document.getElementById('submitBtn');
    const originalText = submitBtn.textContent;
    
    // Disable button and show loading
    submitBtn.disabled = true;
    submitBtn.textContent = 'Criando conta...';
    submitBtn.classList.add('opacity-50');
    
    // Get form data
    const formData = {
        name: document.getElementById('name').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone: document.getElementById('phone').value.replace(/\D/g, ''),
        cpf: document.getElementById('cpf').value.replace(/\D/g, '')
    };
    
    // Validate CPF
    if (!isValidCPF(formData.cpf)) {
        alert('CPF inválido. Por favor, verifique o número digitado.');
        resetButton();
        return;
    }
    
    // Validate phone
    if (formData.phone.length < 10) {
        alert('Telefone inválido. Por favor, digite um número válido.');
        resetButton();
        return;
    }
    
    try {
        // API Call: POST /api/v1/clientes
        console.log(`API Call: POST ${API_BASE}/clientes`);
        console.log('Customer data:', {
            name: formData.name,
            email: formData.email,
            phone: formData.phone,
            cpf: formatCPFForDisplay(formData.cpf)
        });
        
        // Simulate API call
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        // Check for email/phone conflicts
        // In real implementation, these would be actual API responses
        const emailExists = Math.random() < 0.1; // 10% chance of email conflict
        const phoneExists = Math.random() < 0.1; // 10% chance of phone conflict
        
        if (emailExists) {
            throw new Error('EMAIL_EXISTS');
        }
        
        if (phoneExists) {
            throw new Error('PHONE_EXISTS');
        }
        
        // Success
        showSuccessMessage();
        
    } catch (error) {
        console.error('Signup error:', error);
        
        if (error.message === 'EMAIL_EXISTS') {
            alert('Este email já está cadastrado. Tente fazer login ou use outro email.');
        } else if (error.message === 'PHONE_EXISTS') {
            alert('Este telefone já está cadastrado. Tente fazer login ou use outro número.');
        } else {
            alert('Erro ao criar conta. Tente novamente em alguns instantes.');
        }
    } finally {
        resetButton();
    }
    
    function resetButton() {
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
        submitBtn.classList.remove('opacity-50');
    }
}

function formatCPFForDisplay(cpf) {
    return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
}

function showSuccessMessage() {
    // Replace form with success message
    const formContainer = document.querySelector('.bg-white.rounded-2xl');
    formContainer.innerHTML = `
        <div class="text-center py-8">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#10b981" viewBox="0 0 256 256">
                    <path d="M176.49,95.51a12,12,0,0,1,0,17l-56,56a12,12,0,0,1-17,0l-24-24a12,12,0,1,1,17-17L112,143l47.51-47.52A12,12,0,0,1,176.49,95.51Z"></path>
                </svg>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 mb-4">Conta criada com sucesso!</h2>
            <p class="text-gray-600 mb-6">Bem-vindo(a) à AlgExpress! Agora você pode fazer seus pedidos e acumular pontos de fidelidade.</p>
            <div class="space-y-3">
                <button onclick="window.location.href='public_menu.html'" class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-3 px-6 rounded-lg font-semibold hover:from-orange-600 hover:to-red-600 transition-all">
                    Ver Cardápio
                </button>
                <button onclick="window.location.href='customer_account.html'" class="w-full bg-white border border-gray-300 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-50 transition-all">
                    Ir para Minha Conta
                </button>
            </div>
        </div>
    `;
}

// Initialize page
window.onload = function() {
    // Focus on first input
    document.getElementById('name').focus();
};
</script>

</body>
</html>